<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="google-site-verification" content="JlYgOqZ2QujgNAgY4yUni1otZAxr7-SP9D3h50IYo0I"><title>How I solved “error Unable to find vcvarsall.bat” - Hojjat&#x27;s Blog</title><meta name="description" content="TL;DR So, to sum it up, in my case, it looks like that I needed both Microsoft Build Tools 2015 and 2017. And then I needed to copy and modify vcvarsall.bat into a new folder to make things work. Long version: So, I needed to&hellip;"><meta name="robots" content="index, follow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://hojjatabdollahi.github.io/how-i-solved-error-unable-to-find-vcvarsallbat.html"><link rel="alternate" type="application/atom+xml" href="https://hojjatabdollahi.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://hojjatabdollahi.github.io/feed.json"><meta property="og:title" content="How I solved “error Unable to find vcvarsall.bat”"><meta property="og:image" content="https://hojjatabdollahi.github.io/media/website/1-1VP7np2H17ecc1j8roHGvQ.jpeg"><meta property="og:site_name" content="Hojjat's Blog"><meta property="og:description" content="TL;DR So, to sum it up, in my case, it looks like that I needed both Microsoft Build Tools 2015 and 2017. And then I needed to copy and modify vcvarsall.bat into a new folder to make things work. Long version: So, I needed to&hellip;"><meta property="og:url" content="https://hojjatabdollahi.github.io/how-i-solved-error-unable-to-find-vcvarsallbat.html"><meta property="og:type" content="article"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Roboto:400,700&amp;subset=latin-ext&amp;display=swap" rel="stylesheet"><style>h1,h2,h3,h4,h5,h6,.btn,[type=button],[type=submit],button,.navbar .navbar__menu li,.navbar_mobile_sidebar .navbar__menu li,.feed__author,.post__tag,.post__share>a span,.post__nav-link>span,.footer{font-family:'Roboto',sans-serif}body,blockquote,.search__input,.author__name,.author__info>p,.post__nav-link{font-family:'Open Sans',sans-serif}</style><link rel="stylesheet" href="https://hojjatabdollahi.github.io/assets/css/style.css?v=cc87cb8806c844f0646558fe70d5c5d1"><link rel="stylesheet" href="https://hojjatabdollahi.github.io/assets/css/prism.css?v=d32345b346e3a0e14777d298004b804b"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://hojjatabdollahi.github.io/how-i-solved-error-unable-to-find-vcvarsallbat.html"},"headline":"How I solved “error Unable to find vcvarsall.bat”","datePublished":"2018-10-05T17:15","dateModified":"2020-03-23T17:15","image":{"@type":"ImageObject","url":"https://hojjatabdollahi.github.io/media/website/1-1VP7np2H17ecc1j8roHGvQ.jpeg","height":255,"width":256},"description":"TL;DR So, to sum it up, in my case, it looks like that I needed both Microsoft Build Tools 2015 and 2017. And then I needed to copy and modify vcvarsall.bat into a new folder to make things work. Long version: So, I needed to&hellip;","author":{"@type":"Person","name":"Hojjat"},"publisher":{"@type":"Organization","name":"Hojjat","logo":{"@type":"ImageObject","url":"https://hojjatabdollahi.github.io/media/website/1-1VP7np2H17ecc1j8roHGvQ.jpeg","height":255,"width":256}}}</script><script src="https://hojjatabdollahi.github.io/assets/js/ls.parent-fit.min.js?v=f8467455ea5c88e3e51a4f212d2632bd"></script><script async src="https://hojjatabdollahi.github.io/assets/js/lazysizes.min.js?v=6a69d476c93de2b78a72acb259abccea"></script></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://hojjatabdollahi.github.io/"><img src="https://hojjatabdollahi.github.io/media/website/1-1VP7np2H17ecc1j8roHGvQ.jpeg" alt="Hojjat&#x27;s Blog"></a><div class="search"><div class="search__overlay js-search-overlay"><div class="search__overlay-inner"><form action="https://hojjatabdollahi.github.io/search.html" class="search__form"><input class="search__input js-search-input" type="search" name="q" placeholder="search..." autofocus="autofocus"></form><button class="search__close js-search-close" aria-label="Close">Close</button></div></div><button class="search__btn js-search-btn" aria-label="Search"><svg role="presentation" focusable="false"><use xlink:href="https://hojjatabdollahi.github.io/assets/svg/svg-map.svg#search"/></svg></button></div></header><main><article class="post"><div class="hero"><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2018-10-05T17:15">October 5, 2018</time></div><h1>How I solved “error Unable to find vcvarsall.bat”</h1><div class="post__meta post__meta--author"><a href="https://hojjatabdollahi.github.io/authors/hojjat/" class="feed__author invert">Hojjat</a></div></div></header></div><div class="wrapper post__entry">TL;DR<br><br>So, to sum it up, in my case, it looks like that I needed both Microsoft Build Tools 2015 and 2017. And then I needed to copy and modify vcvarsall.bat into a new folder to make things work.<br><br>Long version:<br><br>So, I needed to install spaCy on Windows 10 64bit. But when I ran the following command:<br><br><code class="language-bash">pip install spaCy</code><br><br>It says:<br><br><code>error Unable to find vcvarsall.bat</code><br><br>It is because spaCy has no pre-compiled wheels for windows and it tries to compile it for your system. But if your compiler setup is not correct (I don’t know what it should be), then you get the error above.<br><br>Unfortunately, there is no good binary wheels online, I tried to use the binaries provided <a href="https://www.lfd.uci.edu/~gohlke/pythonlibs/">here</a>.<br><br><br>But again, Spacy would try to compile a newer version of thinc and the same error would happen.<br><br>I searched everywhere and installed so many things that I have no idea exactly which one did the trick. But here is what I think helped:<br><br>Note that I installed spaCy in a virtual environment and I used PowerShell with administrator privileges to do so.<br><br>First we need to find where vcvarsall.bat is!<br>On my system it is here:<br><br><code>C:\Program Files (x86)\Microsoft Visual Studio\2017\BuildTools\VC\Auxiliary\Build</code><br><br>I think the reason that vcvarsall.bat is there, is because I installed <a href="https://visualstudio.microsoft.com/downloads/#build-tools-for-visual-studio-2017">Microsoft Build Tools 2017</a>. However, I also have Visual Studio 2017 Community on my machine.<br><br>As you can see, vcvarsall.bat is in my 2017 folder but python 3.5 needs a compiler and it is looking for vcvarsall.bat in 2015 folder, here:<br><code>C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC</code><br>That folder exists on my machine, I think because I installed <a href="https://www.microsoft.com/en-us/download/details.aspx?id=48159">Microsoft Build Tools 2015</a>. But there is no vcvarsall.bat in that folder. Note that Visual Sudio 14.0 is actually Visual Studio 2015. Also, I don’t have Visual Studio 2015 installed on my machine, just Microsoft Build Tools 2015. (I know, it is confusing)<br><br>So, I copied the vcvarsall.bat from the first address (2017), into this new address (2015). Now, it is complaining that it can not find cl.exe or an there is an error with link.exe or something like that.<br><br>Since vcvarsall.bat has relative paths in it, I opened it and replaced all the<br><br><code>%~dp0</code><br><br>with<br><br><code>C:\Program Files (x86)\Microsoft Visual Studio\2017\BuildTools\VC\Auxiliary\Build\</code><br><br>After doing so, the installation for spaCy worked.<br><br>Go figure!</div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on March 23, 2020</p><ul class="post__tag"><li><a href="https://hojjatabdollahi.github.io/python/">python</a></li><li><a href="https://hojjatabdollahi.github.io/spacy/">spacy</a></li><li><a href="https://hojjatabdollahi.github.io/visual-studio/">visual studio</a></li></ul><div class="post__share"></div><div class="post__bio bio"><div class="bio__info"><h3 class="bio__name"><a href="https://hojjatabdollahi.github.io/authors/hojjat/" class="invert" rel="author">Hojjat</a></h3></div></div></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://hojjatabdollahi.github.io/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://hojjatabdollahi.github.io/fix-msb0001-internal-msbuild-error-throwing-from-logger-shutdown.html" class="invert post__nav-link" rel="prev"><span>Previous</span> Fix “MSB0001: Internal MSBuild Error: Throwing from logger shutdown”</a></div><div class="post__nav-next"><a href="https://hojjatabdollahi.github.io/how-to-use-the-same-key-for-git-bash-and-sourcetree.html" class="invert post__nav-link" rel="next"><span>Next</span> How to use the same key for Git Bash and Sourcetree. </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://hojjatabdollahi.github.io/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav><div class="post__related related"><div class="wrapper"><h2 class="h5 related__title">You should also read:</h2><article class="related__item"><div class="feed__meta"><time datetime="2019-01-29T16:56" class="feed__date">January 29, 2019</time></div><h3 class="h1"><a href="https://hojjatabdollahi.github.io/could-not-find-valid-device-for-node-while-eagerly-executing.html" class="invert">“Could not find valid device for node.” while eagerly executing.</a></h3></article></div></div><div class="post__comments"><div class="wrapper"><h2 class="h5">Comments</h2><div id="disqus_thread"></div><script>var disqus_config = function () {
                       this.page.url = 'https://hojjatabdollahi.github.io/how-i-solved-error-unable-to-find-vcvarsallbat.html';
               		this.page.identifier = '9';
                       this.page.title = ' How I solved “error Unable to find vcvarsall.bat”';
                   };
               
                   var disqus_loaded = false;
               
                   function publiiLoadDisqus() {
                       if(disqus_loaded) {
                           return false;
                       }
               
                       var top = document.getElementById('disqus_thread').offsetTop;
               
                       if (!disqus_loaded && (window.scrollY || window.pageYOffset) + window.innerHeight > top) {
                           disqus_loaded = true;
               
                           (function () {
                               var d = document, s = d.createElement('script');
                               s.src = 'https://hojjata.disqus.com/embed.js';
                               s.setAttribute('data-timestamp', +new Date());
                               (d.head || d.body).appendChild(s);
                           })();
                       }
                   }
               
                   publiiLoadDisqus();
               
                   window.onscroll = function() {
                       publiiLoadDisqus();
                   };</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" target="_blank" rel="nofollow noopener noreferrer">comments powered by Disqus.</a></noscript></div></div></main><footer class="footer"><div class="footer__copyright">Powered by <a href="https://getpublii.com" target="_blank" rel="nofollow noopener noreferrer">Publii Static CMS</a></div><button class="footer__bttop js-footer__bttop" aria-label="Back to top"><svg><title>Back to top</title><use xlink:href="https://hojjatabdollahi.github.io/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.top',
   };</script><script defer="defer" src="https://hojjatabdollahi.github.io/assets/js/scripts.min.js?v=205f40927e4a45297a0b266e50ad78d5"></script><script defer="defer" src="https://hojjatabdollahi.github.io/assets/js/prism.js?v=d581dee7f6d6df406d3a6fff31ad7f3b"></script><script>var lazyFeaturedImage=function lazyFeaturedImage(){var b=document.querySelectorAll(".hero__image-img");for(var a=0;a<b.length;a++){var c=b[a];c.addEventListener("lazyloaded",function(f){var d=f.target.parentNode;d.classList.add("hero__image--overlay")})}};lazyFeaturedImage();</script></body></html>